<!DOCTYPE html>
<html>
  <head>
    <title>My experiment</title>
    <script src="jspsych/dist/jspsych.js"></script>
    <script src="js/jquery-3.6.0.min.js"></script>
    <script src="jspsych/dist/plugin-html-keyboard-response.js"></script>
    <script src="jspsych/dist/plugin-survey-text.js"></script>
    <script src="jspsych/dist/plugin-survey-multi-choice.js"></script>
    <script src="jspsych/dist/plugin-survey.js"></script>
    <script src="jspsych/dist/plugin-survey-html-form.js"></script>
    <script src="jspsych/dist/plugin-audio-keyboard-response.js"></script>
    <script src="js/webgazer/webgazer.js"></script>
    <script src="jspsych/dist/extension-webgazer.js"></script>
    <script src="jspsych/dist/plugin-webgazer-calibrate.js"></script>
    <script src="jspsych/dist/plugin-webgazer-init-camera.js"></script>
    <script src="jspsych/dist/plugin-webgazer-validate.js"></script>
    <script src="jspsych/dist/plugin-preload.js"></script>
    <script src="jspsych/dist/plugin-survey-likert.js"></script>
    <script src="jspsych/dist/plugin-html-button-response.js"></script>
    <script src="jspsych/dist/plugin-fullscreen.js"></script>
    <script src="jspsych/dist/plugin-call-function.js"></script>
    <script src="main.js"></script>
    <link href="jspsych/dist/jspsych.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="jspsych/dist/survey.css">
    <link rel="stylesheet" href="customSurvey.css">
  </head>
  <body>
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        ensureWebcam(() => {
          console.log('Webcam verf√ºgbar, Experiment kann gestartet werden');
          startExp();
        });
       });

      function ensureWebcam(callback) {
        $('body').html('<p class="center" style="font-family:Arial, Helvetica, sans-serif">Checking webcam ... give permission to start the experiment.</p>');
        
        // accessing the webcam
        window.navigator.mediaDevices.getUserMedia({ video: true })
          .then(function(stream) {
            stream.getTracks().forEach(track => track.stop());
            
          callback();
          })
          .catch(function() {
            alert('Cannot open webcam.\nIs it blocked? This study requires a webcam.');
            location.reload();
          });
      }

    </script>
  </body>
</html>